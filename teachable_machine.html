<script type="text/html" data-help-name="teachable machine">
    <p>A <a href="https://www.tensorflow.org/js" target = "_new">tensorflow.js</a> node to run custom trained <a href="https://teachablemachine.withgoogle.com" target = "_new">Teachable Machine</a> image classification online models.</p>
    <h3>Inputs</h3>
        <dl class="message-properties">
            <dt>payload<span class="property-type">image buffer</span></dt>
                <dd>A binary buffer of an image</dd>
        </dl>
    <h3>Outputs</h3>
        <dl class="message-properties">    
            <dt>payload<span class="property-type">object | array</span></dt>
                <dd><ul>
                    <li><code>nameClass</code> <i>string</i></li>
                    <li><code>probability</code> <i>float</i></li>
                </ul></dd>
            <dt>classes<span class="property-type">array</span></dt>
                <dd>All the possible class names in a list</dd>
        </dl>
    <h3>Details</h3>
        <p>You must set the Model URL obtained from the uploaded model in the <a href="https://teachablemachine.withgoogle.com" target = "_new">Teachable Machine</a>.</p>
        <p>You can set the <code>msg.payload</code> to be the best result as one <code>json</code> object or to be an array of all <code>json</code> results. The results will not be ordered by probability.</p>
        <p>Probability is defined as <code>%</code> and the range goes from <code>0</code> to <code>1</code>.

</script>
  
<script type="text/html" data-template-name="teachable machine">
    <!-- Set Model URL -->
    <div class="form-row">
        <label for="node-input-modelUrl"><i class="fa fa-globe"></i> Model URL</label>
        <input type="text" id="node-input-modelUrl" placeholder="https://teachablemachine.withgoogle.com/model/[...]">
    </div>
    <!-- Save Image Checkbox -->
    <div class="form-row">
        <label for="node-input-output"><i class="fa fa-sign-out"></i> Output</label>
        <select type="text" id="node-input-output">
            <option value="best" selected> Best prediction</option>
            <option value="all"> All predictions</option>
        </select>
    </div>
    <!--     <div class="form-row">
        <label for="node-input-checkbox"><i class="fa fa-list-ol"></i> Predictions</label>
        <input type="checkbox" id="node-input-checkbox" style="display:inline-block; width:20px; vertical-align:baseline;"> text that explains checkbox<code>msg.payload</code>
    </div> -->
    <!-- Set Classification Threshold -->
    <!--     <div class="form-row">
        <label for="node-input-threshold"><i class="fa fa-signal"></i> Threshold</label>
        <input type="text" id="node-input-threshold" placeholder="e.g. 0 - 1">
    </div>  -->
    <!-- Set the Name of the Node -->
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/javascript">
  RED.nodes.registerType('teachable machine',
  {
    category: 'analysis-function',
    color: '#ED782F',
    defaults: {
      name: { value: '' },
      modelUrl: { value: '', required: true },
      output: { value: 'best', required: true }
      // threshold: {value: 0.5},
    },
    inputs: 1,
    outputs: 1,
    icon: 'tfjs.png',
    label: function () {
      return this.name || 'teachable machine'
    }
  })
</script>